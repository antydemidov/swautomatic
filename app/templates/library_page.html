{% extends "layout.html" %}

{% block content %}
<script>
    function show_loader() {
        var div = document.getElementById("loader").style.display;
        if (div == "") div = "none";
        if (div == "none") { div = "block"; } else { div = "none"; }
        document.getElementById("loader").style.display = div;
    }
</script>

<div class="loader" id="loader">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24"
        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" class="feather feather-loader">
        <line x1="12" y1="2" x2="12" y2="6"></line>
        <line x1="12" y1="18" x2="12" y2="22"></line>
        <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line>
        <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line>
        <line x1="2" y1="12" x2="6" y2="12"></line>
        <line x1="18" y1="12" x2="22" y2="12"></line>
        <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line>
        <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>
        <animateTransform attributeName="transform" dur="2s" type="rotate" from="0" to="360" repeatCount="indefinite" />
    </svg>
</div>

<div class="library_page_head shadow rounded_block">
    <img src="{{ preview_path }}">
    <h1>{{ asset.name }}</h1>
</div>

<div class="library_page_underhead shadow rounded_block">
    <form class="library_page_toolbar" method="post">
        {% if asset.need_update == True %}
        <button name="download_asset" value="true" type="submit" hover-content="Update asset" formmethod="post"
            onClick="show_loader();">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-refresh-cw">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        </button>
        {% elif asset.is_installed == True %}
        <button name="downloaded_asset" value="False" type="button" style="cursor:not-allowed"
            hover-content="Asset is downloaded">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-check">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        </button>
        {% else %}
        <button name="download_asset" value="true" type="submit" hover-content="Download asset" formmethod="post"
            onClick="show_loader();">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
                stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-download"
                viewBox="0 0 24 24">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <path d="M7 10L12 15 17 10" />
                <path d="M12 15L12 3" />
            </svg>
        </button>
        {% endif %}
        <button class="library_toolbar_item" type="submit" hover-content="Update record" value="true" name="update_asset"
            onClick="show_loader();">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        </button>
        <button class="library_toolbar_item bordered" disabled="disabled" hover-content="Coming soon!" action="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-trash-2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        </button>
        <button class="library_toolbar_item bordered" disabled="disabled" hover-content="Coming soon!"></button>
    </form>
    <div class="library_page_author">
        <img class="button" src="{{ asset.author.avatar_icon }}">
        <p>{{ asset.author.steam_id }}</p>
    </div>
</div>
<div class="library_page_content">
    <table class="library_page_table shadow rounded_block">
        <tr>
            <th>Steam ID</th>
            <td>{{ asset.steamid }}</td>
        </tr>
        <tr>
            <th>Tags</th>
            <td>
                {% for tag in asset.tags %}
                <a href="{{ url_for('library', tag=tag.tag) }}">{{ tag.tag }}</a>
                {% endfor %}
            </td>
        </tr>
        <tr>
            <th>File size</th>
            <td>{{ file_size }}</td>
        </tr>
        <tr>
            <th>Time created</th>
            <td>{{ asset.time_created }}</td>
        </tr>
        <tr>
            <th>Time updated</th>
            <td>{{ asset.time_updated }}</td>
        </tr>
    </table>
    <div class="library_page_requirements shadow rounded_block"></div>
</div>
<div class="library_page_files shadow rounded_block">
    <table class="library_page_files_table">
        {% for path, data in files %}
        <tr>
            <th>{{data['id']}}</th>
            <td>{{path}}</td>
            <td>{{data['size']}}</td>
            <td class="library_page_files_table_button">
                <button type="submit" disabled="disabled" value="{{data['id']}}" hover-content="Coming soon!">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="feather feather-trash-2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                </button>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>

{% endblock %}